function is_touch_device(){return"ontouchstart"in window||navigator.maxTouchPoints}function toggleFullScreen(t){t=t||document.documentElement,document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}function startFullScreen(){document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}function endFullScreen(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function ifProp(t,e,i){return t.hasOwnProperty(e)?t[e]:i}function makeCanvas(t,e,i){for(var o=t.slides,n=0,s=0;s<o.length;s++)for(var r=0;r<o[s].text.length;r++)n++;var a="",l="",c="",u="",h="",d="";if(is_touch_device()?(h='<div class="sc-tap-forward-zone"></div>',d='<div class="sc-tap-backward-zone"></div>'):(a='<div class="sc-left-nav"><a href="#" class="sc-back" title="back"><i class="fa fa-chevron-circle-left" aria-hidden="true"></i></a></div>',l='<div class="sc-right-nav"><a href="#" class="sc-forward" title="forward"><i class="fa fa-chevron-circle-right" aria-hidden="true"></i></a></div>'),"fullscreen"==i){var p="#"+e+"-fullscreen";$("body").append('<div id="blackout">&nbsp;</div>'),$("body").append('<div id="'+e+'-fullscreen" class="sc-container '+e+'"></div>'),is_touch_device()||(c='<a href="#" class="sc-go-fullscreen" title="fullscreen mode"><i class="fa fa-arrows-alt" aria-hidden="true"></i></a>&nbsp;&nbsp;&nbsp;');var u='<a href="#" class="sc-close" title="close window"><i class="fa fa-times" aria-hidden="true"></i></a>'}else{var p="#"+e+"-container";$(p).addClass(e),$(p).addClass("sc-embedded");var u='<a href="#" class="'+e+'-open" title="expand"><i class="fa fa-expand" aria-hidden="true"></i></a>'}$(p).html('<div class="story-canvas"></div>'+h+d+'<div class="sc-toolbar"><div class="sc-toolbar-right">'+c+'<a href="#" class="sc-zoom" title="zoom image"><i class="fa fa-search-plus" aria-hidden="true"></i></a><a href="#" class="sc-unzoom" title="unzoom"><i class="fa fa-search-minus" aria-hidden="true"></i></a>&nbsp;&nbsp;&nbsp;'+u+'</div><div class="sc-toolbar-left"><a href="#" class="sc-restart" title="start over"><i class="fa fa-fast-backward" aria-hidden="true"></i></a>&nbsp;&nbsp;&nbsp;<span class="sc-position">1</span>/'+n+"</div></div>"+a+l);for(var s=0;s<o.length;s++)if(o[s].img&&($(p+" .story-canvas").append('<div class="sc-image-box sc-image-box-'+s+'"></div>'),$(p+" .story-canvas .sc-image-box-"+s).append('<img src="'+o[s].img+'" alt="'+o[s].alt+'" class="sc-image sc-image-'+s+'" />')),o[s].text){for(var r=0;r<o[s].text.length;r++){var f="sc-image-"+s+"-text-"+r;$(p+" .story-canvas").append('<div " class="sc-text '+f+'" />'),$(p+" ."+f).css(getTextFormatting(o[s],i)),$(p+" ."+f).html(o[s].text[r])}$(p+" .sc-image-box-"+s).css(getImageBoxFormatting(o[s],i,s,r))}if(configureWindow(o,p),"fullscreen"==i&&($("."+e+"-open").click(function(){return openFullScreen(p),fullscreen=!0,!1}),$(".sc-close").click(function(){return closeFullScreen(p),!1}),$(".sc-go-fullscreen").click(function(){tryFullScreen&&toggleFullScreen()}),$(document).keydown(function(t){if(37==t.keyCode&&fullscreen)return(0!=imgPosition||0!=textPosition)&&moveBackward(p,o),!1;if(39==t.keyCode&&fullscreen){var e=o.length-1,i=o[e].text.length-1;return(imgPosition!=e||textPosition!=i)&&moveForward(p,o),!1}return 27==t.keyCode&&fullscreen?(closeFullScreen(p),!1):void 0}),$(window).on("orientationchange",function(t){setTimeout(function(){fullscreen&&"portrait"==t.orientation&&window.scrollBy(0,-100)},500)})),$(p+" .sc-forward").click(function(){return moveForward(p,o),!1}),$(p+" .sc-back").click(function(){return moveBackward(p,o),!1}),$(p+" .sc-restart").click(function(){return hideSlide(p,imgPosition,textPosition,!1),textPosition=0,imgPosition=0,position=1,$(".sc-back").css({visibility:"hidden"}),$(".sc-forward").css({visibility:"visible"}),$(".sc-position").text(position),$(".sc-restart").css({color:backgroundColor}),showSlide(imgPosition,textPosition,p,o),!1}),$(p+" .sc-zoom").click(function(){zoom(p,imgPosition)}),$(p+" .sc-unzoom").click(function(){unzoom(p,imgPosition)}),is_touch_device()){$(p+" .sc-tap-backward-zone").on("tap",function(){(0!=imgPosition||0!=textPosition)&&moveBackward(p,o)}),$(p+" .sc-image").on("touchstart",function(t){m?(clearTimeout(m),m=null,imgZoomed?unzoom(p,imgPosition):zoom(p,imgPosition)):m=setTimeout(function(){m=null},300)});var m=!1;$(p+" .sc-tap-forward-zone").on("touchstart",function(t){m?(clearTimeout(m),m=null,imgZoomed?unzoom(p,imgPosition):zoom(p,imgPosition)):m=setTimeout(function(){m=null;var t=o.length-1,e=o[t].text.length-1;(imgPosition!=t||textPosition!=e)&&moveForward(p,o)},300)})}else{$(p).mouseout(function(){(0!=imgPosition||0!=textPosition)&&($(".sc-left-nav").hide(),$(".sc-right-nav").hide(),$(".sc-toolbar").hide(),$(".story-canvas").stop().animate({top:0},1e3))}),$(p).mouseover(function(){$(".sc-left-nav").show(),$(".sc-right-nav").show(),$(".sc-toolbar").show(),$(".story-canvas").stop().css({top:"34px"})}),$(p+" .sc-image").css({cursor:"zoom-in"});var g=!1;$(p+" .sc-image").mousedown(function(){g=!1}).mousemove(function(){g=!0}).mouseup(function(){var t=g;g=!1,t||(imgZoomed?unzoom(p,imgPosition):zoom(p,imgPosition))})}}function moveBackward(t,e){position--,0!=textPosition?(hideSlide(t,imgPosition,textPosition,!0),textPosition--,showSlide(imgPosition,textPosition,t,e)):(hideSlide(t,imgPosition,textPosition,!1),imgPosition--,textPosition=e[imgPosition].text.length-1,showSlide(imgPosition,textPosition,t,e)),$(".sc-forward").css({visibility:"visible"}),$(".sc-restart").css({color:backgroundColor}),0==imgPosition&&0==textPosition&&$(".sc-back").css({visibility:"hidden"}),$(".sc-position").text(position)}function moveForward(t,e){if(position++,textPosition<e[imgPosition].text.length-1)hideSlide(t,imgPosition,textPosition,!0),textPosition++,showSlide(imgPosition,textPosition,t,e);else{hideSlide(t,imgPosition,textPosition,!1);imgPosition;imgPosition++,textPosition=0,showSlide(imgPosition,textPosition,t,e)}$(".sc-back").css({visibility:"visible"}),imgPosition==e.length-1&&textPosition==e[imgPosition].text.length-1&&($(".sc-forward").css({visibility:"hidden"}),$(".sc-restart").css({color:"white"})),$(".sc-position").text(position)}function closeFullScreen(t){$("#blackout").hide(),$(t).hide(),$("html, body").css({overflow:"auto",height:"auto"}),$("body").unbind(),unzoom(t,imgPosition),fullscreen=!1,tryFullScreen&&endFullScreen()}function openFullScreen(t){window.scrollTo(0,0),$("html, body").css({overflow:"hidden",height:"auto"}),$(t).fadeIn(),$("#blackout").show(),unzoom(t,imgPosition),fullscreen=!0}function configureWindow(t,e){$(e+" .sc-image-"+imgPosition).show(),$(".sc-text").hide();var i="sc-image-"+imgPosition+"-text-"+textPosition;$("."+i).fadeIn(200)}function showSlide(t,e,i,o){var n="sc-image-"+t,s="sc-image-"+t+"-text-"+e;if($("."+n).length?$("."+n).parent().stop().fadeIn(1e3,function(){$("."+s).stop().fadeIn(500)}):$("."+s).stop().fadeIn(500),slide=o[t],slide.hasOwnProperty("textFormatting")){ifProp(slide.textFormatting,"overlay",!0)}}function hideSlide(t,e,i,o,n){var s="sc-image-"+e+"-text-"+i;o||$(".sc-image-"+e).parent().stop().fadeOut(200),$("."+s).stop().fadeOut(200),unzoom(t,e)}function zoom(t,e){img=$(t+" .sc-image-"+e).get(0),img&&(imgHeight=img.naturalHeight,imgWidth=img.naturalWidth,boxHeight=$(img).parent().height(),boxWidth=$(img).parent().width(),height=(boxHeight-imgHeight)/2,width=(boxWidth-imgWidth)/2,$(t+" .sc-image-"+e).css({maxWidth:"none",maxHeight:"none",transform:"none",zIndex:5e3}).draggable(),$(t+" .sc-image-"+e).css({top:height,left:width,margin:0,height:imgHeight,width:imgWidth,cursor:"move"}),$(".sc-zoom").hide(),$(".sc-tap-forward-zone").hide(),$(".sc-tap-backward-zone").hide(),$(".sc-unzoom").show(),imgZoomed=!0)}function unzoom(t,e){$(t+" .sc-image-"+e).data("ui-draggable")&&$(t+" .sc-image-"+e).draggable("destroy").css({maxWidth:"100%",maxHeight:"100%",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}).css({width:"auto",height:"auto",position:"absolute",zIndex:1e3,cursor:"zoom-in"}),$(".sc-unzoom").hide(),$(".sc-zoom").show(),$(".sc-tap-forward-zone").show(),$(".sc-tap-backward-zone").show(),imgZoomed=!1}function getTextFormatting(t,e){return tf=t.textFormatting,myobj={fontSize:tf.fontSize,color:tf.color,backgroundColor:tf.backgroundColor,opacity:tf.opacity,transform:tf.transform,top:tf.top,bottom:tf.bottom},myobj}function getImageBoxFormatting(t,e){var i={};return t.textFormatting.overlay||(i.bottom="55px"),i}function getImageFormatting(t,e){var i=$(t+" .sc-image-"+e).get(0);return i?(imgHeight=i.naturalHeight,imgWidth=i.naturalWidth,boxHeight=$(i).parent().height(),boxWidth=$(i).parent().width(),top=(boxHeight-imgHeight)/2,left=(boxWidth-imgWidth)/2,alert(imgHeight+":"+imgWidth+"  "+boxHeight+":"+boxWidth),{left:left,top:top}):{}}!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(e,o){var n,s,r,a=e.nodeName.toLowerCase();return"area"===a?(n=e.parentNode,s=n.name,e.href&&s&&"map"===n.nodeName.toLowerCase()?(r=t("img[usemap='#"+s+"']")[0],!!r&&i(r)):!1):(/^(input|select|textarea|button|object)$/.test(a)?!e.disabled:"a"===a?e.href||o:o)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var i=this.css("position"),o="absolute"===i,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,s=this.parents().filter(function(){var e=t(this);return o&&"static"===e.css("position")?!1:n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&s.length?s:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,o){return!!t.data(e,o[3])},focusable:function(i){return e(i,!isNaN(t.attr(i,"tabindex")))},tabbable:function(i){var o=t.attr(i,"tabindex"),n=isNaN(o);return(n||o>=0)&&e(i,!n)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,i){function o(e,i,o,s){return t.each(n,function(){i-=parseFloat(t.css(e,"padding"+this))||0,o&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),s&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),r={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?r["inner"+i].call(this):this.each(function(){t(this).css(s,o(this,e)+"px")})},t.fn["outer"+i]=function(e,n){return"number"!=typeof e?r["outer"+i].call(this,e):this.each(function(){t(this).css(s,o(this,e,!0,n)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(i,o){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),o&&o.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var i,o,n=t(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(o=parseInt(n.css("zIndex"),10),!isNaN(o)&&0!==o))return o;n=n.parent()}return 0}}),t.ui.plugin={add:function(e,i,o){var n,s=t.ui[e].prototype;for(n in o)s.plugins[n]=s.plugins[n]||[],s.plugins[n].push([i,o[n]])},call:function(t,e,i,o){var n,s=t.plugins[e];if(s&&(o||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(n=0;s.length>n;n++)t.options[s[n][0]]&&s[n][1].apply(t.element,i)}};var o=0,n=Array.prototype.slice;t.cleanData=function(e){return function(i){var o,n,s;for(s=0;null!=(n=i[s]);s++)try{o=t._data(n,"events"),o&&o.remove&&t(n).triggerHandler("remove")}catch(r){}e(i)}}(t.cleanData),t.widget=function(e,i,o){var n,s,r,a,l={},c=e.split(".")[0];return e=e.split(".")[1],n=c+"-"+e,o||(o=i,i=t.Widget),t.expr[":"][n.toLowerCase()]=function(e){return!!t.data(e,n)},t[c]=t[c]||{},s=t[c][e],r=t[c][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new r(t,e)},t.extend(r,s,{version:o.version,_proto:t.extend({},o),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(o,function(e,o){return t.isFunction(o)?void(l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},n=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,s=this._superApply;return this._super=t,this._superApply=n,e=o.apply(this,arguments),this._super=i,this._superApply=s,e}}()):void(l[e]=o)}),r.prototype=t.widget.extend(a,{widgetEventPrefix:s?a.widgetEventPrefix||e:e},l,{constructor:r,namespace:c,widgetName:e,widgetFullName:n}),s?(t.each(s._childConstructors,function(e,i){var o=i.prototype;t.widget(o.namespace+"."+o.widgetName,r,i._proto)}),delete s._childConstructors):i._childConstructors.push(r),t.widget.bridge(e,r),r},t.widget.extend=function(e){for(var i,o,s=n.call(arguments,1),r=0,a=s.length;a>r;r++)for(i in s[r])o=s[r][i],s[r].hasOwnProperty(i)&&void 0!==o&&(e[i]=t.isPlainObject(o)?t.isPlainObject(e[i])?t.widget.extend({},e[i],o):t.widget.extend({},o):o);return e},t.widget.bridge=function(e,i){var o=i.prototype.widgetFullName||e;t.fn[e]=function(s){var r="string"==typeof s,a=n.call(arguments,1),l=this;return r?this.each(function(){var i,n=t.data(this,o);return"instance"===s?(l=n,!1):n?t.isFunction(n[s])&&"_"!==s.charAt(0)?(i=n[s].apply(n,a),i!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):t.error("no such method '"+s+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+s+"'")}):(a.length&&(s=t.widget.extend.apply(null,[s].concat(a))),this.each(function(){var e=t.data(this,o);e?(e.option(s||{}),e._init&&e._init()):t.data(this,o,new i(s,this))})),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=o++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var o,n,s,r=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(r={},o=e.split("."),e=o.shift(),o.length){for(n=r[e]=t.widget.extend({},this.options[e]),s=0;o.length-1>s;s++)n[o[s]]=n[o[s]]||{},n=n[o[s]];if(e=o.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];r[e]=i}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,i,o){var n,s=this;"boolean"!=typeof e&&(o=i,i=e,e=!1),o?(i=n=t(i),this.bindings=this.bindings.add(i)):(o=i,i=this.element,n=this.widget()),t.each(o,function(o,r){function a(){return e||s.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof r?s[r]:r).apply(s,arguments):void 0}"string"!=typeof r&&(a.guid=r.guid=r.guid||a.guid||t.guid++);var l=o.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+s.eventNamespace,u=l[2];u?n.delegate(u,c,a):i.bind(c,a)})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(i).undelegate(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return("string"==typeof t?o[t]:t).apply(o,arguments)}var o=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,o){var n,s,r=this.options[e];if(o=o||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(n in s)n in i||(i[n]=s[n]);return this.element.trigger(i,o),!(t.isFunction(r)&&r.apply(this.element[0],[i].concat(o))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(o,n,s){"string"==typeof n&&(n={effect:n});var r,a=n?n===!0||"number"==typeof n?i:n.effect||i:e;n=n||{},"number"==typeof n&&(n={duration:n}),r=!t.isEmptyObject(n),n.complete=s,n.delay&&o.delay(n.delay),r&&t.effects&&t.effects.effect[a]?o[e](n):a!==e&&o[a]?o[a](n.duration,n.easing,s):o.queue(function(i){t(this)[e](),s&&s.call(o[0]),i()})}}),t.widget;var s=!1;t(document).mouseup(function(){s=!1}),t.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!s){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,o=1===e.which,n="string"==typeof this.options.cancel&&e.target.nodeName?t(e.target).closest(this.options.cancel).length:!1;return o&&!n&&this._mouseCapture(e)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),s=!0,!0)):!0}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),s=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function e(t,e,i){return[parseFloat(t[0])*(p.test(t[0])?e/100:1),parseFloat(t[1])*(p.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}function o(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var n,s,r=Math.max,a=Math.abs,l=Math.round,c=/left|center|right/,u=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,p=/%$/,f=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==n)return n;var e,i,o=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=o.children()[0];return t("body").append(o),e=s.offsetWidth,o.css("overflow","scroll"),i=s.offsetWidth,e===i&&(i=o[0].clientWidth),o.remove(),n=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),o=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),n="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,s="scroll"===o||"auto"===o&&e.height<e.element[0].scrollHeight;return{width:s?t.position.scrollbarWidth():0,height:n?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),o=t.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:o,isDocument:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:o||n?i.width():i.outerWidth(),height:o||n?i.height():i.outerHeight()}}},t.fn.position=function(n){if(!n||!n.of)return f.apply(this,arguments);n=t.extend({},n);var p,m,g,v,b,w,y=t(n.of),_=t.position.getWithinInfo(n.within),x=t.position.getScrollInfo(_),P=(n.collision||"flip").split(" "),T={};return w=o(y),y[0].preventDefault&&(n.at="left top"),m=w.width,g=w.height,v=w.offset,b=t.extend({},v),t.each(["my","at"],function(){var t,e,i=(n[this]||"").split(" ");1===i.length&&(i=c.test(i[0])?i.concat(["center"]):u.test(i[0])?["center"].concat(i):["center","center"]),i[0]=c.test(i[0])?i[0]:"center",i[1]=u.test(i[1])?i[1]:"center",t=h.exec(i[0]),e=h.exec(i[1]),T[this]=[t?t[0]:0,e?e[0]:0],n[this]=[d.exec(i[0])[0],d.exec(i[1])[0]]}),1===P.length&&(P[1]=P[0]),"right"===n.at[0]?b.left+=m:"center"===n.at[0]&&(b.left+=m/2),"bottom"===n.at[1]?b.top+=g:"center"===n.at[1]&&(b.top+=g/2),p=e(T.at,m,g),b.left+=p[0],b.top+=p[1],this.each(function(){var o,c,u=t(this),h=u.outerWidth(),d=u.outerHeight(),f=i(this,"marginLeft"),w=i(this,"marginTop"),E=h+f+i(this,"marginRight")+x.width,S=d+w+i(this,"marginBottom")+x.height,$=t.extend({},b),C=e(T.my,u.outerWidth(),u.outerHeight());"right"===n.my[0]?$.left-=h:"center"===n.my[0]&&($.left-=h/2),"bottom"===n.my[1]?$.top-=d:"center"===n.my[1]&&($.top-=d/2),$.left+=C[0],$.top+=C[1],s||($.left=l($.left),$.top=l($.top)),o={marginLeft:f,marginTop:w},t.each(["left","top"],function(e,i){t.ui.position[P[e]]&&t.ui.position[P[e]][i]($,{targetWidth:m,targetHeight:g,elemWidth:h,elemHeight:d,collisionPosition:o,collisionWidth:E,collisionHeight:S,offset:[p[0]+C[0],p[1]+C[1]],my:n.my,at:n.at,within:_,elem:u})}),n.using&&(c=function(t){var e=v.left-$.left,i=e+m-h,o=v.top-$.top,s=o+g-d,l={target:{element:y,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:$.left,top:$.top,width:h,height:d},horizontal:0>i?"left":e>0?"right":"center",vertical:0>s?"top":o>0?"bottom":"middle"};h>m&&m>a(e+i)&&(l.horizontal="center"),d>g&&g>a(o+s)&&(l.vertical="middle"),l.important=r(a(e),a(i))>r(a(o),a(s))?"horizontal":"vertical",n.using.call(this,t,l)}),u.offset(t.extend($,{using:c}))})},t.ui.position={fit:{left:function(t,e){var i,o=e.within,n=o.isWindow?o.scrollLeft:o.offset.left,s=o.width,a=t.left-e.collisionPosition.marginLeft,l=n-a,c=a+e.collisionWidth-s-n;e.collisionWidth>s?l>0&&0>=c?(i=t.left+l+e.collisionWidth-s-n,t.left+=l-i):t.left=c>0&&0>=l?n:l>c?n+s-e.collisionWidth:n:l>0?t.left+=l:c>0?t.left-=c:t.left=r(t.left-a,t.left)},top:function(t,e){var i,o=e.within,n=o.isWindow?o.scrollTop:o.offset.top,s=e.within.height,a=t.top-e.collisionPosition.marginTop,l=n-a,c=a+e.collisionHeight-s-n;e.collisionHeight>s?l>0&&0>=c?(i=t.top+l+e.collisionHeight-s-n,t.top+=l-i):t.top=c>0&&0>=l?n:l>c?n+s-e.collisionHeight:n:l>0?t.top+=l:c>0?t.top-=c:t.top=r(t.top-a,t.top)}},flip:{left:function(t,e){var i,o,n=e.within,s=n.offset.left+n.scrollLeft,r=n.width,l=n.isWindow?n.scrollLeft:n.offset.left,c=t.left-e.collisionPosition.marginLeft,u=c-l,h=c+e.collisionWidth-r-l,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>u?(i=t.left+d+p+f+e.collisionWidth-r-s,(0>i||a(u)>i)&&(t.left+=d+p+f)):h>0&&(o=t.left-e.collisionPosition.marginLeft+d+p+f-l,(o>0||h>a(o))&&(t.left+=d+p+f))},top:function(t,e){var i,o,n=e.within,s=n.offset.top+n.scrollTop,r=n.height,l=n.isWindow?n.scrollTop:n.offset.top,c=t.top-e.collisionPosition.marginTop,u=c-l,h=c+e.collisionHeight-r-l,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,m=-2*e.offset[1];0>u?(o=t.top+p+f+m+e.collisionHeight-r-s,(0>o||a(u)>o)&&(t.top+=p+f+m)):h>0&&(i=t.top-e.collisionPosition.marginTop+p+f+m-l,(i>0||h>a(i))&&(t.top+=p+f+m))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,o,n,r,a=document.getElementsByTagName("body")[0],l=document.createElement("div");e=document.createElement(a?"div":"body"),o={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},a&&t.extend(o,{position:"absolute",left:"-1000px",top:"-1000px"});for(r in o)e.style[r]=o[r];e.appendChild(l),i=a||document.documentElement,i.insertBefore(e,i.firstChild),l.style.cssText="position: absolute; left: 10.7432222px;",n=t(l).offset().left,s=n>10&&11>n,e.innerHTML="",i.removeChild(e)}()}(),t.ui.position,t.widget("ui.draggable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var i=this.options;return this._blurActiveElement(e),this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=this.document[0];if(this.handleElement.is(e.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&t(i.activeElement).blur()}catch(o){}},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={
top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var o=this._uiHash();if(this._trigger("drag",e,o)===!1)return this._mouseUp({}),!1;this.position=o.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,o=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(o=t.ui.ddmanager.drop(this,e)),this.dropped&&(o=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!o||"valid"===this.options.revert&&o||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,o)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var i=this.options,o=t.isFunction(i.helper),n=o?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),o&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,o,n=this.options,s=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===n.containment?void(this.containment=[0,0,t(s).width()-this.helperProportions.width-this.margins.left,(t(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):n.containment.constructor===Array?void(this.containment=n.containment):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=t(n.containment),o=i[0],void(o&&(e=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(o.scrollWidth,o.offsetWidth):o.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(o.scrollHeight,o.offsetHeight):o.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,o=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:o?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:o?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,o,n,s,r=this.options,a=this._isRootNode(this.scrollParent[0]),l=t.pageX,c=t.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(o=this.relativeContainer.offset(),i=[this.containment[0]+o.left,this.containment[1]+o.top,this.containment[2]+o.left,this.containment[3]+o.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(c=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(c=i[3]+this.offset.click.top)),r.grid&&(n=r.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/r.grid[1])*r.grid[1]:this.originalPageY,c=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-r.grid[1]:n+r.grid[1]:n,s=r.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/r.grid[0])*r.grid[0]:this.originalPageX,l=i?s-this.offset.click.left>=i[0]||s-this.offset.click.left>i[2]?s:s-this.offset.click.left>=i[0]?s-r.grid[0]:s+r.grid[0]:s),"y"===r.axis&&(l=this.originalPageX),"x"===r.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,i,o){return o=o||this._uiHash(),t.ui.plugin.call(this,e,[i,o,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),o.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,o)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,o){var n=t.extend({},i,{item:o.element});o.sortables=[],t(o.options.connectToSortable).each(function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(o.sortables.push(i),i.refreshPositions(),i._trigger("activate",e,n))})},stop:function(e,i,o){var n=t.extend({},i,{item:o.element});o.cancelHelperRemoval=!1,t.each(o.sortables,function(){var t=this;t.isOver?(t.isOver=0,o.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,n))})},drag:function(e,i,o){t.each(o.sortables,function(){var n=!1,s=this;s.positionAbs=o.positionAbs,s.helperProportions=o.helperProportions,s.offset.click=o.offset.click,s._intersectsWith(s.containerCache)&&(n=!0,t.each(o.sortables,function(){return this.positionAbs=o.positionAbs,this.helperProportions=o.helperProportions,this.offset.click=o.offset.click,this!==s&&this._intersectsWith(this.containerCache)&&t.contains(s.element[0],this.element[0])&&(n=!1),n})),n?(s.isOver||(s.isOver=1,o._parent=i.helper.parent(),s.currentItem=i.helper.appendTo(s.element).data("ui-sortable-item",!0),s.options._helper=s.options.helper,s.options.helper=function(){return i.helper[0]},e.target=s.currentItem[0],s._mouseCapture(e,!0),s._mouseStart(e,!0,!0),s.offset.click.top=o.offset.click.top,s.offset.click.left=o.offset.click.left,s.offset.parent.left-=o.offset.parent.left-s.offset.parent.left,s.offset.parent.top-=o.offset.parent.top-s.offset.parent.top,o._trigger("toSortable",e),o.dropped=s.element,t.each(o.sortables,function(){this.refreshPositions()}),o.currentItem=o.element,s.fromOutside=o),s.currentItem&&(s._mouseDrag(e),i.position=s.position)):s.isOver&&(s.isOver=0,s.cancelHelperRemoval=!0,s.options._revert=s.options.revert,s.options.revert=!1,s._trigger("out",e,s._uiHash(s)),s._mouseStop(e,!0),s.options.revert=s.options._revert,s.options.helper=s.options._helper,s.placeholder&&s.placeholder.remove(),i.helper.appendTo(o._parent),o._refreshOffsets(e),i.position=o._generatePosition(e,!0),o._trigger("fromSortable",e),o.dropped=!1,t.each(o.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,o){var n=t("body"),s=o.options;n.css("cursor")&&(s._cursor=n.css("cursor")),n.css("cursor",s.cursor)},stop:function(e,i,o){var n=o.options;n._cursor&&t("body").css("cursor",n._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,o){var n=t(i.helper),s=o.options;n.css("opacity")&&(s._opacity=n.css("opacity")),n.css("opacity",s.opacity)},stop:function(e,i,o){var n=o.options;n._opacity&&t(i.helper).css("opacity",n._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,o){var n=o.options,s=!1,r=o.scrollParentNotHidden[0],a=o.document[0];r!==a&&"HTML"!==r.tagName?(n.axis&&"x"===n.axis||(o.overflowOffset.top+r.offsetHeight-e.pageY<n.scrollSensitivity?r.scrollTop=s=r.scrollTop+n.scrollSpeed:e.pageY-o.overflowOffset.top<n.scrollSensitivity&&(r.scrollTop=s=r.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(o.overflowOffset.left+r.offsetWidth-e.pageX<n.scrollSensitivity?r.scrollLeft=s=r.scrollLeft+n.scrollSpeed:e.pageX-o.overflowOffset.left<n.scrollSensitivity&&(r.scrollLeft=s=r.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-t(a).scrollTop()<n.scrollSensitivity?s=t(a).scrollTop(t(a).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(a).scrollTop())<n.scrollSensitivity&&(s=t(a).scrollTop(t(a).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-t(a).scrollLeft()<n.scrollSensitivity?s=t(a).scrollLeft(t(a).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(a).scrollLeft())<n.scrollSensitivity&&(s=t(a).scrollLeft(t(a).scrollLeft()+n.scrollSpeed)))),s!==!1&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(o,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,o){var n=o.options;o.snapElements=[],t(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=t(this),i=e.offset();this!==o.element[0]&&o.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i,o){var n,s,r,a,l,c,u,h,d,p,f=o.options,m=f.snapTolerance,g=i.offset.left,v=g+o.helperProportions.width,b=i.offset.top,w=b+o.helperProportions.height;for(d=o.snapElements.length-1;d>=0;d--)l=o.snapElements[d].left-o.margins.left,c=l+o.snapElements[d].width,u=o.snapElements[d].top-o.margins.top,h=u+o.snapElements[d].height,l-m>v||g>c+m||u-m>w||b>h+m||!t.contains(o.snapElements[d].item.ownerDocument,o.snapElements[d].item)?(o.snapElements[d].snapping&&o.options.snap.release&&o.options.snap.release.call(o.element,e,t.extend(o._uiHash(),{snapItem:o.snapElements[d].item})),o.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(n=m>=Math.abs(u-w),s=m>=Math.abs(h-b),r=m>=Math.abs(l-v),a=m>=Math.abs(c-g),n&&(i.position.top=o._convertPositionTo("relative",{top:u-o.helperProportions.height,left:0}).top),s&&(i.position.top=o._convertPositionTo("relative",{top:h,left:0}).top),r&&(i.position.left=o._convertPositionTo("relative",{top:0,left:l-o.helperProportions.width}).left),a&&(i.position.left=o._convertPositionTo("relative",{top:0,left:c}).left)),p=n||s||r||a,"outer"!==f.snapMode&&(n=m>=Math.abs(u-b),s=m>=Math.abs(h-w),r=m>=Math.abs(l-g),a=m>=Math.abs(c-v),n&&(i.position.top=o._convertPositionTo("relative",{top:u,left:0}).top),s&&(i.position.top=o._convertPositionTo("relative",{top:h-o.helperProportions.height,left:0}).top),r&&(i.position.left=o._convertPositionTo("relative",{top:0,left:l}).left),a&&(i.position.left=o._convertPositionTo("relative",{top:0,left:c-o.helperProportions.width}).left)),!o.snapElements[d].snapping&&(n||s||r||a||p)&&o.options.snap.snap&&o.options.snap.snap.call(o.element,e,t.extend(o._uiHash(),{snapItem:o.snapElements[d].item})),o.snapElements[d].snapping=n||s||r||a||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,o){var n,s=o.options,r=t.makeArray(t(s.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});r.length&&(n=parseInt(t(r[0]).css("zIndex"),10)||0,t(r).each(function(e){t(this).css("zIndex",n+e)}),this.css("zIndex",n+r.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,o){var n=t(i.helper),s=o.options;n.css("zIndex")&&(s._zIndex=n.css("zIndex")),n.css("zIndex",s.zIndex)},stop:function(e,i,o){var n=o.options;n._zIndex&&t(i.helper).css("zIndex",n._zIndex)}}),t.ui.draggable}),function(){var t=$.support.touch,e=t?"touchstart":"mousedown",i=t?"touchend":"mouseup",o=t?"touchmove":"mousemove";$.event.special.swipeupdown={setup:function(){var t=this,n=$(t);n.bind(e,function(t){function e(t){if(a){var e=t.originalEvent.touches?t.originalEvent.touches[0]:t;s={time:(new Date).getTime(),coords:[e.pageX,e.pageY]},Math.abs(a.coords[1]-s.coords[1])>10&&t.preventDefault()}}var s,r=t.originalEvent.touches?t.originalEvent.touches[0]:t,a={time:(new Date).getTime(),coords:[r.pageX,r.pageY],origin:$(t.target)};n.bind(o,e).one(i,function(t){n.unbind(o,e),a&&s&&s.time-a.time<1e3&&Math.abs(a.coords[1]-s.coords[1])>30&&Math.abs(a.coords[0]-s.coords[0])<75&&a.origin.trigger("swipeupdown").trigger(a.coords[1]>s.coords[1]?"swipeup":"swipedown"),a=s=void 0})})}},$.each({swipedown:"swipeupdown",swipeup:"swipeupdown"},function(t,e){$.event.special[t]={setup:function(){$(this).bind(e,$.noop)}}})}(),!function(t){function e(t,e){if(!(t.originalEvent.touches.length>1)){t.preventDefault();var i=t.originalEvent.changedTouches[0],o=document.createEvent("MouseEvents");o.initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(o)}}if(t.support.touch="ontouchend"in document,t.support.touch){var i,o=t.ui.mouse.prototype,n=o._mouseInit,s=o._mouseDestroy;o._touchStart=function(t){var o=this;!i&&o._mouseCapture(t.originalEvent.changedTouches[0])&&(i=!0,o._touchMoved=!1,e(t,"mouseover"),e(t,"mousemove"),e(t,"mousedown"))},o._touchMove=function(t){i&&(this._touchMoved=!0,e(t,"mousemove"))},o._touchEnd=function(t){i&&(e(t,"mouseup"),e(t,"mouseout"),this._touchMoved||e(t,"click"),i=!1)},o._mouseInit=function(){var e=this;e.element.bind({touchstart:t.proxy(e,"_touchStart"),touchmove:t.proxy(e,"_touchMove"),touchend:t.proxy(e,"_touchEnd")}),n.call(e)},o._mouseDestroy=function(){var e=this;e.element.unbind({touchstart:t.proxy(e,"_touchStart"),touchmove:t.proxy(e,"_touchMove"),touchend:t.proxy(e,"_touchEnd")}),s.call(e)}}}(jQuery),!function(t,e,i,o){"use strict";function n(t,e,i){return setTimeout(c(t,i),e)}function s(t,e,i){return Array.isArray(t)?(r(t,i[e],i),!0):!1}function r(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==o)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function a(e,i,o){var n="DEPRECATED METHOD: "+i+"\n"+o+" AT \n";return function(){var i=new Error("get-stack-trace"),o=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=t.console&&(t.console.warn||t.console.log);return s&&s.call(t.console,n,o),e.apply(this,arguments)}}function l(t,e,i){var o,n=e.prototype;o=t.prototype=Object.create(n),o.constructor=t,o._super=n,i&&ht(o,i)}function c(t,e){return function(){return t.apply(e,arguments)}}function u(t,e){return typeof t==ft?t.apply(e?e[0]||o:o,e):t}function h(t,e){return t===o?e:t}function d(t,e,i){r(g(e),function(e){t.addEventListener(e,i,!1)})}function p(t,e,i){r(g(e),function(e){t.removeEventListener(e,i,!1)})}function f(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function m(t,e){return t.indexOf(e)>-1}function g(t){return t.trim().split(/\s+/g)}function v(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var o=0;o<t.length;){if(i&&t[o][i]==e||!i&&t[o]===e)return o;o++}return-1}function b(t){return Array.prototype.slice.call(t,0)}function w(t,e,i){for(var o=[],n=[],s=0;s<t.length;){var r=e?t[s][e]:t[s];v(n,r)<0&&o.push(t[s]),n[s]=r,s++}return i&&(o=e?o.sort(function(t,i){return t[e]>i[e]}):o.sort()),o}function y(t,e){for(var i,n,s=e[0].toUpperCase()+e.slice(1),r=0;r<dt.length;){if(i=dt[r],n=i?i+s:e,n in t)return n;r++}return o}function _(){return yt++}function x(e){var i=e.ownerDocument||e;return i.defaultView||i.parentWindow||t}function P(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){u(t.options.enable,[t])&&i.handler(e)},this.init()}function T(t){var e,i=t.options.inputClass;return new(e=i?i:Pt?O:Tt?L:xt?X:M)(t,E)}function E(t,e,i){var o=i.pointers.length,n=i.changedPointers.length,s=e&It&&o-n===0,r=e&(Ht|kt)&&o-n===0;i.isFirst=!!s,i.isFinal=!!r,s&&(t.session={}),i.eventType=e,S(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function S(t,e){var i=t.session,o=e.pointers,n=o.length;i.firstInput||(i.firstInput=D(e)),n>1&&!i.firstMultiple?i.firstMultiple=D(e):1===n&&(i.firstMultiple=!1);var s=i.firstInput,r=i.firstMultiple,a=r?r.center:s.center,l=e.center=I(o);e.timeStamp=vt(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=z(a,l),e.distance=k(a,l),$(i,e),e.offsetDirection=H(e.deltaX,e.deltaY);var c=W(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=c.x,e.overallVelocityY=c.y,e.overallVelocity=gt(c.x)>gt(c.y)?c.x:c.y,e.scale=r?N(r.pointers,o):1,e.rotation=r?F(r.pointers,o):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,C(i,e);var u=t.element;f(e.srcEvent.target,u)&&(u=e.srcEvent.target),e.target=u}function $(t,e){var i=e.center,o=t.offsetDelta||{},n=t.prevDelta||{},s=t.prevInput||{};e.eventType!==It&&s.eventType!==Ht||(n=t.prevDelta={x:s.deltaX||0,y:s.deltaY||0},o=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=n.x+(i.x-o.x),e.deltaY=n.y+(i.y-o.y)}function C(t,e){var i,n,s,r,a=t.lastInterval||e,l=e.timeStamp-a.timeStamp;if(e.eventType!=kt&&(l>Dt||a.velocity===o)){var c=e.deltaX-a.deltaX,u=e.deltaY-a.deltaY,h=W(l,c,u);n=h.x,s=h.y,i=gt(h.x)>gt(h.y)?h.x:h.y,r=H(c,u),t.lastInterval=e}else i=a.velocity,n=a.velocityX,s=a.velocityY,r=a.direction;e.velocity=i,e.velocityX=n,e.velocityY=s,e.direction=r}function D(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:mt(t.pointers[i].clientX),clientY:mt(t.pointers[i].clientY)},i++;return{timeStamp:vt(),pointers:e,center:I(e),deltaX:t.deltaX,deltaY:t.deltaY}}function I(t){var e=t.length;if(1===e)return{x:mt(t[0].clientX),y:mt(t[0].clientY)};for(var i=0,o=0,n=0;e>n;)i+=t[n].clientX,o+=t[n].clientY,n++;return{x:mt(i/e),y:mt(o/e)}}function W(t,e,i){return{x:e/t||0,y:i/t||0}}function H(t,e){return t===e?zt:gt(t)>=gt(e)?0>t?Ft:Nt:0>e?Mt:Ot}function k(t,e,i){i||(i=Yt);var o=e[i[0]]-t[i[0]],n=e[i[1]]-t[i[1]];return Math.sqrt(o*o+n*n)}function z(t,e,i){i||(i=Yt);var o=e[i[0]]-t[i[0]],n=e[i[1]]-t[i[1]];return 180*Math.atan2(n,o)/Math.PI}function F(t,e){return z(e[1],e[0],Xt)+z(t[1],t[0],Xt)}function N(t,e){return k(e[0],e[1],Xt)/k(t[0],t[1],Xt)}function M(){this.evEl=Bt,this.evWin=Ut,this.pressed=!1,P.apply(this,arguments)}function O(){this.evEl=Gt,this.evWin=Vt,P.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function A(){this.evTarget=Qt,this.evWin=Jt,this.started=!1,P.apply(this,arguments)}function R(t,e){var i=b(t.touches),o=b(t.changedTouches);return e&(Ht|kt)&&(i=w(i.concat(o),"identifier",!0)),[i,o]}function L(){this.evTarget=ee,this.targetIds={},P.apply(this,arguments)}function Y(t,e){var i=b(t.touches),o=this.targetIds;if(e&(It|Wt)&&1===i.length)return o[i[0].identifier]=!0,[i,i];var n,s,r=b(t.changedTouches),a=[],l=this.target;if(s=i.filter(function(t){return f(t.target,l)}),e===It)for(n=0;n<s.length;)o[s[n].identifier]=!0,n++;for(n=0;n<r.length;)o[r[n].identifier]&&a.push(r[n]),e&(Ht|kt)&&delete o[r[n].identifier],n++;return a.length?[w(s.concat(a),"identifier",!0),a]:void 0}function X(){P.apply(this,arguments);var t=c(this.handler,this);this.touch=new L(this.manager,t),this.mouse=new M(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function q(t,e){t&It?(this.primaryTouch=e.changedPointers[0].identifier,B.call(this,e)):t&(Ht|kt)&&B.call(this,e)}function B(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY};this.lastTouches.push(i);var o=this.lastTouches,n=function(){var t=o.indexOf(i);t>-1&&o.splice(t,1)};setTimeout(n,ie)}}function U(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,o=0;o<this.lastTouches.length;o++){var n=this.lastTouches[o],s=Math.abs(e-n.x),r=Math.abs(i-n.y);if(oe>=s&&oe>=r)return!0}return!1}function j(t,e){this.manager=t,this.set(e)}function Z(t){if(m(t,ce))return ce;var e=m(t,ue),i=m(t,he);return e&&i?ce:e||i?e?ue:he:m(t,le)?le:ae}function G(){if(!se)return!1;var e={},i=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(o){e[o]=i?t.CSS.supports("touch-action",o):!0}),e}function V(t){this.options=ht({},this.defaults,t||{}),this.id=_(),this.manager=null,this.options.enable=h(this.options.enable,!0),this.state=pe,this.simultaneous={},this.requireFail=[]}function K(t){return t&be?"cancel":t&ge?"end":t&me?"move":t&fe?"start":""}function Q(t){return t==Ot?"down":t==Mt?"up":t==Ft?"left":t==Nt?"right":""}function J(t,e){var i=e.manager;return i?i.get(t):t}function tt(){V.apply(this,arguments)}function et(){tt.apply(this,arguments),this.pX=null,this.pY=null}function it(){tt.apply(this,arguments)}function ot(){V.apply(this,arguments),this._timer=null,this._input=null}function nt(){tt.apply(this,arguments)}function st(){tt.apply(this,arguments)}function rt(){V.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function at(t,e){return e=e||{},e.recognizers=h(e.recognizers,at.defaults.preset),new lt(t,e)}function lt(t,e){this.options=ht({},at.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=T(this),this.touchAction=new j(this,this.options.touchAction),ct(this,!0),r(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ct(t,e){var i=t.element;if(i.style){var o;r(t.options.cssProps,function(n,s){o=y(i.style,s),e?(t.oldCssProps[o]=i.style[o],i.style[o]=n):i.style[o]=t.oldCssProps[o]||""}),e||(t.oldCssProps={})}}function ut(t,i){var o=e.createEvent("Event");o.initEvent(t,!0,!0),o.gesture=i,i.target.dispatchEvent(o)}var ht,dt=["","webkit","Moz","MS","ms","o"],pt=e.createElement("div"),ft="function",mt=Math.round,gt=Math.abs,vt=Date.now;ht="function"!=typeof Object.assign?function(t){if(t===o||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==o&&null!==n)for(var s in n)n.hasOwnProperty(s)&&(e[s]=n[s])}return e}:Object.assign;var bt=a(function(t,e,i){for(var n=Object.keys(e),s=0;s<n.length;)(!i||i&&t[n[s]]===o)&&(t[n[s]]=e[n[s]]),s++;return t},"extend","Use `assign`."),wt=a(function(t,e){return bt(t,e,!0)},"merge","Use `assign`."),yt=1,_t=/mobile|tablet|ip(ad|hone|od)|android/i,xt="ontouchstart"in t,Pt=y(t,"PointerEvent")!==o,Tt=xt&&_t.test(navigator.userAgent),Et="touch",St="pen",$t="mouse",Ct="kinect",Dt=25,It=1,Wt=2,Ht=4,kt=8,zt=1,Ft=2,Nt=4,Mt=8,Ot=16,At=Ft|Nt,Rt=Mt|Ot,Lt=At|Rt,Yt=["x","y"],Xt=["clientX","clientY"];P.prototype={handler:function(){},init:function(){this.evEl&&d(this.element,this.evEl,this.domHandler),this.evTarget&&d(this.target,this.evTarget,this.domHandler),this.evWin&&d(x(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(x(this.element),this.evWin,this.domHandler)}};var qt={mousedown:It,mousemove:Wt,mouseup:Ht},Bt="mousedown",Ut="mousemove mouseup";l(M,P,{handler:function(t){var e=qt[t.type];e&It&&0===t.button&&(this.pressed=!0),e&Wt&&1!==t.which&&(e=Ht),this.pressed&&(e&Ht&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:$t,srcEvent:t}))}});var jt={pointerdown:It,pointermove:Wt,pointerup:Ht,pointercancel:kt,pointerout:kt},Zt={2:Et,3:St,4:$t,5:Ct},Gt="pointerdown",Vt="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Gt="MSPointerDown",Vt="MSPointerMove MSPointerUp MSPointerCancel"),l(O,P,{handler:function(t){var e=this.store,i=!1,o=t.type.toLowerCase().replace("ms",""),n=jt[o],s=Zt[t.pointerType]||t.pointerType,r=s==Et,a=v(e,t.pointerId,"pointerId");n&It&&(0===t.button||r)?0>a&&(e.push(t),a=e.length-1):n&(Ht|kt)&&(i=!0),0>a||(e[a]=t,this.callback(this.manager,n,{pointers:e,changedPointers:[t],pointerType:s,srcEvent:t}),i&&e.splice(a,1))}});var Kt={touchstart:It,touchmove:Wt,touchend:Ht,touchcancel:kt},Qt="touchstart",Jt="touchstart touchmove touchend touchcancel";l(A,P,{handler:function(t){var e=Kt[t.type];if(e===It&&(this.started=!0),this.started){var i=R.call(this,t,e);e&(Ht|kt)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:Et,srcEvent:t})}}});var te={touchstart:It,touchmove:Wt,touchend:Ht,touchcancel:kt},ee="touchstart touchmove touchend touchcancel";l(L,P,{handler:function(t){var e=te[t.type],i=Y.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:Et,srcEvent:t})}});var ie=2500,oe=25;l(X,P,{handler:function(t,e,i){var o=i.pointerType==Et,n=i.pointerType==$t;if(!(n&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(o)q.call(this,e,i);else if(n&&U.call(this,i))return;this.callback(t,e,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ne=y(pt.style,"touchAction"),se=ne!==o,re="compute",ae="auto",le="manipulation",ce="none",ue="pan-x",he="pan-y",de=G();j.prototype={set:function(t){t==re&&(t=this.compute()),se&&this.manager.element.style&&de[t]&&(this.manager.element.style[ne]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return r(this.manager.recognizers,function(e){u(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),Z(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var o=this.actions,n=m(o,ce)&&!de[ce],s=m(o,he)&&!de[he],r=m(o,ue)&&!de[ue];if(n){var a=1===t.pointers.length,l=t.distance<2,c=t.deltaTime<250;if(a&&l&&c)return}return r&&s?void 0:n||s&&i&At||r&&i&Rt?this.preventSrc(e):void 0},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var pe=1,fe=2,me=4,ge=8,ve=ge,be=16,we=32;V.prototype={defaults:{},set:function(t){return ht(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(s(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=J(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return s(t,"dropRecognizeWith",this)?this:(t=J(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(s(t,"requireFailure",this))return this;var e=this.requireFail;return t=J(t,this),-1===v(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(s(t,"dropRequireFailure",this))return this;t=J(t,this);var e=v(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){i.manager.emit(e,t)}var i=this,o=this.state;ge>o&&e(i.options.event+K(o)),e(i.options.event),t.additionalEvent&&e(t.additionalEvent),o>=ge&&e(i.options.event+K(o))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=we)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(we|pe)))return!1;t++}return!0},recognize:function(t){var e=ht({},t);return u(this.options.enable,[this,e])?(this.state&(ve|be|we)&&(this.state=pe),this.state=this.process(e),void(this.state&(fe|me|ge|be)&&this.tryEmit(e))):(this.reset(),void(this.state=we))},process:function(t){},getTouchAction:function(){},reset:function(){}},l(tt,V,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,o=e&(fe|me),n=this.attrTest(t);return o&&(i&kt||!n)?e|be:o||n?i&Ht?e|ge:e&fe?e|me:fe:we}}),l(et,tt,{defaults:{event:"pan",threshold:10,pointers:1,direction:Lt},getTouchAction:function(){var t=this.options.direction,e=[];return t&At&&e.push(he),t&Rt&&e.push(ue),e},directionTest:function(t){var e=this.options,i=!0,o=t.distance,n=t.direction,s=t.deltaX,r=t.deltaY;return n&e.direction||(e.direction&At?(n=0===s?zt:0>s?Ft:Nt,
i=s!=this.pX,o=Math.abs(t.deltaX)):(n=0===r?zt:0>r?Mt:Ot,i=r!=this.pY,o=Math.abs(t.deltaY))),t.direction=n,i&&o>e.threshold&&n&e.direction},attrTest:function(t){return tt.prototype.attrTest.call(this,t)&&(this.state&fe||!(this.state&fe)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Q(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),l(it,tt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ce]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&fe)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),l(ot,V,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ae]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,o=t.distance<e.threshold,s=t.deltaTime>e.time;if(this._input=t,!o||!i||t.eventType&(Ht|kt)&&!s)this.reset();else if(t.eventType&It)this.reset(),this._timer=n(function(){this.state=ve,this.tryEmit()},e.time,this);else if(t.eventType&Ht)return ve;return we},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===ve&&(t&&t.eventType&Ht?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=vt(),this.manager.emit(this.options.event,this._input)))}}),l(nt,tt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ce]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&fe)}}),l(st,tt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:At|Rt,pointers:1},getTouchAction:function(){return et.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(At|Rt)?e=t.overallVelocity:i&At?e=t.overallVelocityX:i&Rt&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&i&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&gt(e)>this.options.velocity&&t.eventType&Ht},emit:function(t){var e=Q(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),l(rt,V,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[le]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,o=t.distance<e.threshold,s=t.deltaTime<e.time;if(this.reset(),t.eventType&It&&0===this.count)return this.failTimeout();if(o&&s&&i){if(t.eventType!=Ht)return this.failTimeout();var r=this.pTime?t.timeStamp-this.pTime<e.interval:!0,a=!this.pCenter||k(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,a&&r?this.count+=1:this.count=1,this._input=t;var l=this.count%e.taps;if(0===l)return this.hasRequireFailures()?(this._timer=n(function(){this.state=ve,this.tryEmit()},e.interval,this),fe):ve}return we},failTimeout:function(){return this._timer=n(function(){this.state=we},this.options.interval,this),we},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ve&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),at.VERSION="2.0.8",at.defaults={domEvents:!1,touchAction:re,enable:!0,inputTarget:null,inputClass:null,preset:[[nt,{enable:!1}],[it,{enable:!1},["rotate"]],[st,{direction:At}],[et,{direction:At},["swipe"]],[rt],[rt,{event:"doubletap",taps:2},["tap"]],[ot]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ye=1,_e=2;lt.prototype={set:function(t){return ht(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?_e:ye},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var i,o=this.recognizers,n=e.curRecognizer;(!n||n&&n.state&ve)&&(n=e.curRecognizer=null);for(var s=0;s<o.length;)i=o[s],e.stopped===_e||n&&i!=n&&!i.canRecognizeWith(n)?i.reset():i.recognize(t),!n&&i.state&(fe|me|ge)&&(n=e.curRecognizer=i),s++}},get:function(t){if(t instanceof V)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(s(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(s(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,i=v(e,t);-1!==i&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){if(t!==o&&e!==o){var i=this.handlers;return r(g(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this}},off:function(t,e){if(t!==o){var i=this.handlers;return r(g(t),function(t){e?i[t]&&i[t].splice(v(i[t],e),1):delete i[t]}),this}},emit:function(t,e){this.options.domEvents&&ut(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var o=0;o<i.length;)i[o](e),o++}},destroy:function(){this.element&&ct(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ht(at,{INPUT_START:It,INPUT_MOVE:Wt,INPUT_END:Ht,INPUT_CANCEL:kt,STATE_POSSIBLE:pe,STATE_BEGAN:fe,STATE_CHANGED:me,STATE_ENDED:ge,STATE_RECOGNIZED:ve,STATE_CANCELLED:be,STATE_FAILED:we,DIRECTION_NONE:zt,DIRECTION_LEFT:Ft,DIRECTION_RIGHT:Nt,DIRECTION_UP:Mt,DIRECTION_DOWN:Ot,DIRECTION_HORIZONTAL:At,DIRECTION_VERTICAL:Rt,DIRECTION_ALL:Lt,Manager:lt,Input:P,TouchAction:j,TouchInput:L,MouseInput:M,PointerEventInput:O,TouchMouseInput:X,SingleTouchInput:A,Recognizer:V,AttrRecognizer:tt,Tap:rt,Pan:et,Swipe:st,Pinch:it,Rotate:nt,Press:ot,on:d,off:p,each:r,merge:wt,extend:bt,assign:ht,inherit:l,bindFn:c,prefixed:y});var xe="undefined"!=typeof t?t:"undefined"!=typeof self?self:{};xe.Hammer=at,"function"==typeof define&&define.amd?define(function(){return at}):"undefined"!=typeof module&&module.exports?module.exports=at:t[i]=at}(window,document,"Hammer");var sc={canvases:[]};sc_scripts=document.getElementsByTagName("script"),sc_script=sc_scripts[sc_scripts.length-1],sc.currentDirPath=function(){var t=sc_script.src;return console.log(t.substring(0,t.lastIndexOf("/"))),t.substring(0,t.lastIndexOf("/"))},sc.createStoryCanvas=function(t,e,i){console.log("creating "+e),i=i||!1,$("body").append('<div style="display:none;" id="sc-templates"></div>'),$("#sc-templates").load(sc.currentDirPath()+"/templates.html",function(){completeStoryData=sc.setDefaults(t),canvas={slides:completeStoryData.slides,globalSettings:completeStoryData.globalSettings,name:e,canvasDiv:"."+e,embeddedDiv:"#"+e+"-embedded",fullWindowDiv:"#"+e+"-full-window",currentImagePosition:0,currentTextPosition:0,currentSlidePosition:1,slideCount:completeStoryData.slideCount,fullWindowShowing:!1,imageZoomed:!1,toolsHidden:!1},i&&(sc.buildCanvasHTML(canvas,"embedded"),sc.buildStoryHTML(canvas,"embedded"),sc.attachEmbeddedEvents(canvas,"embedded")),sc.buildCanvasHTML(canvas,"fullWindow"),sc.buildStoryHTML(canvas,"fullWindow"),sc.attachFullWindowEvents(canvas,"fullWindow"),sc.attachGlobalCanvasEvents(canvas),is_touch_device()&&sc.attachHammerEvents(canvas),sc.canvases.push(canvas)})},sc.setDefaults=function(t){var e={};for(e.globalSettings=ifProp(t,"globalSettings",{}),e.globalSettings.backgroundColor=ifProp(e.globalSettings,"backgroundColor","#cc3300"),e.globalSettings.toolbarColor=ifProp(e.globalSettings,"toolbarColor","#661a00"),e.globalSettings.emphasisColor=ifProp(e.globalSettings,"emphasisColor","#fff"),e.globalSettings.fullScreenOption=ifProp(e.globalSettings,"fullScreenOption",!0),e.globalSettings.zoomOption=ifProp(e.globalSettings,"zoomOption",!0),e.slides=t.slides,e.slideCount=0,i=0;i<e.slides.length;i++){e.slides[i].text=ifProp(e.slides[i],"text",[""]);var o=ifProp(e.slides[i],"textFormatting",{});o.fontSize=ifProp(o,"fontSize","20px"),o.color=ifProp(o,"color","#FFF"),o.backgroundColor=ifProp(o,"backgroundColor","transparent"),o.opacity=ifProp(o,"opacity",1),o.overlay=ifProp(o,"overlay",!1),o.transform=ifProp(o,"transform","none"),o.overlay?(o.verticalCenter=ifProp(o,"verticalCenter",!1),o.top=ifProp(o,"top","70%"),o.bottom="auto",o.verticalCenter&&(o.top="50%",o.transform="translate(0, -50%)")):(o.top="auto",o.bottom=0),e.slides[i].textFormatting=o,e.slideCount=e.slideCount+e.slides[i].text.length}return e},sc.buildCanvasHTML=function(t,e){console.log("building "+e+" html for "+t.name);var i="",o="",n="",s="",r="",a="";if(is_touch_device()?(r=sc.templateEngine("tap-forward-zone-template"),a=""):(i=sc.templateEngine("left-nav-template"),o=sc.templateEngine("right-nav-template")),"fullWindow"==e){var l=t.fullWindowDiv;$("body").append(sc.templateEngine("blackout-template")),$("body").append(sc.templateEngine("sc-container-template",{canvasName:t.name})),is_touch_device()||(n=sc.templateEngine("fullscreen-tool-template"));var s=sc.templateEngine("contract-tool-template")}else{var l=t.embeddedDiv;$(l).parent().css({position:"relative"}),$(l).addClass(t.name),$(l).addClass("sc-embedded");var s=sc.templateEngine("expand-tool-template",{canvasName:t.name})}$(l).html(sc.templateEngine("story-canvas-template",{tapForwardZone:r,tapBackwardZone:a,fullscreenTool:n,expandContractTool:s,slideCount:t.slideCount,leftNav:i,rightNav:o}))},sc.buildStoryHTML=function(t,e){if(console.log("building "+e+" css for "+t.name),"fullWindow"==e)var i=t.fullWindowDiv;else var i=t.embeddedDiv;for(var o=0;o<t.slides.length;o++){t.slides[o].img&&($(i+" .story-canvas").append('<div class="sc-image-box sc-image-box-'+o+'"></div>'),$(i+" .sc-image-box-"+o).append('<img src="'+t.slides[o].img+'" alt="'+t.slides[o].alt+'" class="sc-image sc-image-'+o+'" />'));for(var n=0;n<t.slides[o].text.length;n++){var s="sc-image-"+o+"-text-"+n;$(i+" .story-canvas").append('<div " class="sc-text '+s+'" />'),$(i+" ."+s).css(getTextFormatting(t.slides[o],e)),$(i+" ."+s).html(t.slides[o].text[n])}$(i+" .sc-image-box-"+o).css(getImageBoxFormatting(t.slides[o],e,o,n))}sc.showSlide(t)},sc.attachGlobalCanvasEvents=function(t){console.log("building global canvas events for "+t.name),$("."+t.name+"-open").click(function(){return sc.openFullWindow(t.name),!1}),$(".sc-go-fullscreen").click(function(){toggleFullScreen()}),$(t.canvasDiv+" .sc-forward").click(function(){return sc.moveForward(t),!1}),$(t.canvasDiv+" .sc-back").click(function(){return sc.moveBackward(t),!1}),$(t.canvasDiv+" .sc-restart").click(function(){return sc.hideSlide(t),t.currentTextPosition=0,t.currentImagePosition=0,t.currentSlidePosition=1,sc.showSlide(t),!1}),is_touch_device()||($(t.canvasDiv).mouseout(function(){1!=t.currentSlidePosition&&sc.hideTools(t)}),$(t.canvasDiv).mouseover(function(){sc.showTools(t)}),$(document).keydown(function(e){return 37==e.keyCode&&1!=t.currentSlidePosition?(sc.moveBackward(t),!1):39==e.keyCode&&t.currentSlidePosition!=t.slideCount?(sc.moveForward(t),!1):27==e.keyCode&&t.fullWindowShowing?(sc.closeFullWindow(t.name),!1):void 0}))},sc.attachEmbeddedEvents=function(t){if(console.log("building embedded events for "+t.name),$(t.embeddedDiv+" .sc-zoom").click(function(){sc.zoom(t,t.embeddedDiv)}),$(t.embeddedDiv+" .sc-unzoom").click(function(){sc.unzoom(t,t.embeddedDiv)}),!is_touch_device()){var e=!1;$(t.embeddedDiv+" .sc-image").mousedown(function(){e=!1}).mousemove(function(){e=!0}).mouseup(function(){var i=e;e=!1,i||(t.imageZoomed?sc.unzoom(t,t.embeddedDiv):sc.zoom(t,t.embeddedDiv))})}},sc.attachFullWindowEvents=function(t){if(console.log("building full window events for "+t.name),$(t.fullWindowDiv+" .sc-close").click(function(){return sc.closeFullWindow(t.name),!1}),$(t.fullWindowDiv+" .sc-zoom").click(function(){sc.zoom(t,t.fullWindowDiv)}),$(t.fullWindowDiv+" .sc-unzoom").click(function(){sc.unzoom(t,t.fullWindowDiv)}),!is_touch_device()){var e=!1;$(t.fullWindowDiv+" .sc-image").mousedown(function(){e=!1}).mousemove(function(){e=!0}).mouseup(function(){var i=e;e=!1,i||(t.imageZoomed?sc.unzoom(t,t.fullWindowDiv):sc.zoom(t,t.fullWindowDiv))})}},sc.attachHammerEvents=function(t){var e=$(t.fullWindowDiv+" .sc-tap-forward-zone").get(0),o=new Hammer.Manager(e),n=new Hammer.Tap({event:"singletap"}),s=new Hammer.Tap({event:"doubletap",taps:2,threshold:5,posThreshold:35,interval:400}),r=new Hammer.Swipe({event:"swipeleft",direction:Hammer.DIRECTION_LEFT}),a=new Hammer.Swipe({event:"swiperight",direction:Hammer.DIRECTION_RIGHT}),l=new Hammer.Swipe({event:"swipeup",direction:Hammer.DIRECTION_UP}),c=new Hammer.Swipe({event:"swipedown",direction:Hammer.DIRECTION_DOWN});s.recognizeWith(n),n.requireFailure(s),o.add([s,n,r,a,l,c]),o.on("singletap",function(e){t.toolsHidden?sc.showTools(t):sc.hideTools(t)}),o.on("doubletap",function(e){sc.zoom(t,t.fullWindowDiv)}),o.on("swipeleft",function(e){sc.moveForward(t)}),o.on("swiperight",function(e){sc.moveBackward(t)}),o.on("swipeup swipedown",function(e){t.toolsHidden?sc.showTools(t):sc.hideTools(t)});var u=$(t.embeddedDiv+" .sc-tap-forward-zone").get(0),h=new Hammer.Manager(u),d=new Hammer.Tap({event:"singletap"}),p=new Hammer.Tap({event:"doubletap",taps:2,threshold:5,posThreshold:35,interval:400}),f=new Hammer.Swipe({event:"swipeleft",direction:Hammer.DIRECTION_LEFT}),m=new Hammer.Swipe({event:"swiperight",direction:Hammer.DIRECTION_RIGHT});p.recognizeWith(d),d.requireFailure(p),h.add([p,d,f,m]),h.on("singletap",function(e){t.toolsHidden?sc.showTools(t):sc.hideTools(t)}),h.on("doubletap",function(e){sc.zoom(t,t.embeddedDiv)}),h.on("swipeleft",function(e){sc.moveForward(t)}),h.on("swiperight",function(e){sc.moveBackward(t)});var g=$(t.fullWindowDiv+" .sc-image").get();for(i=0;i<g.length;i++){var v=new Hammer.Manager(g[i]);v.add(new Hammer.Tap({event:"doubletap",taps:2,threshold:5,posThreshold:35,interval:400})),v.on("doubletap",function(e){sc.unzoom(t,t.fullWindowDiv)})}var b=$(t.embeddedDiv+" .sc-image").get();for(i=0;i<b.length;i++){var w=new Hammer.Manager(b[i]);w.add(new Hammer.Tap({event:"doubletap",taps:2,threshold:5,posThreshold:35,interval:400})),w.on("doubletap",function(e){sc.unzoom(t,t.embeddedDiv)})}},sc.templateEngine=function(t,e){e=e||{};var i=$("#"+t).html();console.log(t);for(arg in e){var o="{{"+arg+"}}";i=i.split(o).join(e[arg])}return i},sc.getTextFormatting=function(t,e){return tf=t.textFormatting,myobj={fontSize:tf.fontSize,color:tf.color,backgroundColor:tf.backgroundColor,opacity:tf.opacity,transform:tf.transform,top:tf.top,bottom:tf.bottom},myobj},sc.getImageBoxFormatting=function(t,e){var i={};return t.textFormatting.overlay||(i.bottom="55px"),i},sc.showTools=function(t){$(".sc-left-nav").show(),$(".sc-right-nav").show(),$(".sc-toolbar").show(),$(".story-canvas").stop().css({top:"34px"}),t.toolsHidden=!1},sc.hideTools=function(t){$(".sc-left-nav").hide(),$(".sc-right-nav").hide(),$(".sc-toolbar").hide(),$(".story-canvas").stop().animate({top:0},1e3),t.toolsHidden=!0},sc.openFullWindow=function(t){$("html, body").css({overflow:"hidden"}),$("#"+t+"-full-window").fadeIn(),$("#blackout").show(),sc.unzoom(canvas,canvas.embeddedDiv),canvas.fullWindowShowing=!0},sc.closeFullWindow=function(t){$("#blackout").hide(),$("#"+t+"-full-window").hide(),$("html, body").css({overflow:"auto"}),$("body").unbind(),sc.unzoom(canvas,canvas.fullWindowDiv),endFullScreen(),canvas.fullWindowShowing=!1},sc.moveBackward=function(t){return 1==t.currentSlidePosition?void(t.toolsHidden&&sc.showTools(t)):(t.currentSlidePosition--,void(0!=t.currentTextPosition?(sc.hideSlide(t),t.currentTextPosition--,sc.showSlide(t)):(sc.hideSlide(t),t.currentImagePosition--,t.currentTextPosition=t.slides[t.currentImagePosition].text.length-1,sc.showSlide(t))))},sc.moveForward=function(t){return t.currentSlidePosition==t.slideCount?void(t.toolsHidden&&sc.showTools(t)):(t.currentSlidePosition++,void(t.currentTextPosition<t.slides[t.currentImagePosition].text.length-1?(sc.hideSlide(t),t.currentTextPosition++,sc.showSlide(t)):(sc.hideSlide(t),t.currentImagePosition++,t.currentTextPosition=0,sc.showSlide(t))))},sc.showSlide=function(t){var e="sc-image-"+t.currentImagePosition,i="sc-image-"+t.currentImagePosition+"-text-"+t.currentTextPosition;$("."+e).length?($("."+e).parent().stop().fadeIn(500,function(){$("."+i).stop().fadeIn(400)}),$(t.canvasDiv+" .sc-zoom").show()):($("."+i).stop().fadeIn(400),$(t.canvasDiv+" .sc-zoom").hide()),1==t.currentSlidePosition?$(".sc-back").css({visibility:"hidden"}):$(".sc-back").css({visibility:"visible"}),t.currentSlidePosition==t.slideCount?($(".sc-forward").css({visibility:"hidden"}),$(".sc-restart").css({visibility:"visible"})):($(".sc-forward").css({visibility:"visible"}),$(".sc-restart").css({visibility:"hidden"})),$(".sc-position").text(t.currentSlidePosition)},sc.hideSlide=function(t){var e="sc-image-"+t.currentImagePosition,i="sc-image-"+t.currentImagePosition+"-text-"+t.currentTextPosition;$("."+e).parent().stop().fadeOut(200),$("."+i).stop().fadeOut(200),sc.unzoom(t,t.fullWindowDiv),sc.unzoom(t,t.embeddedDiv)},sc.zoom=function(t,e){var i=e+" .sc-image-"+t.currentImagePosition;img=$(i).get(0),img&&(imgHeight=img.naturalHeight,imgWidth=img.naturalWidth,boxHeight=$(img).parent().height(),boxWidth=$(img).parent().width(),height=(boxHeight-imgHeight)/2,width=(boxWidth-imgWidth)/2,$(i).css({maxWidth:"none",maxHeight:"none",transform:"none",zIndex:5e3}).draggable(),$(i).css({top:height,left:width,margin:0,height:imgHeight,width:imgWidth,cursor:"move"}),$(e+" .sc-zoom").hide(),$(e+" .sc-tap-forward-zone").hide(),$(e+" .sc-tap-backward-zone").hide(),$(e+" .sc-unzoom").show(),t.imageZoomed=!0)},sc.unzoom=function(t,e){$(e+" .sc-image-"+t.currentImagePosition).data("ui-draggable")&&$(e+" .sc-image-"+t.currentImagePosition).draggable("destroy").css({maxWidth:"100%",maxHeight:"100%",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}).css({width:"auto",height:"auto",position:"absolute",zIndex:1e3,cursor:"zoom-in"}),$(e+" .sc-unzoom").hide(),$(e+" .sc-tap-forward-zone").show(),$(e+" .sc-tap-backward-zone").show(),t.imageZoomed=!1};